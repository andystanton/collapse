<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="css/collapse.css" />

    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="js/dom-to-image.min.js"></script>
    <script type="text/javascript" src="js/three.min.js"></script>
    <script type="text/javascript" src="js/collapse.js"></script>
    <script type="text/javascript">
        var enable = true;

        if (enable) {
            $(window).load(function() {
                COLLAPSE.configure({
                        chunkSize: 4,
                        loop: function(id, obj, tbd) {
                            obj.position.x += obj.direction.x;
                            obj.position.y += obj.direction.y;

                            obj.direction.y -= 4;
                            obj.direction.x *= 0.95;

                            if (obj.position.y < 0) {
                                obj.position.y = 0;
                                obj.direction.x *= 0.9;

                                if (Math.abs(obj.direction.y) < 15) {
                                    tbd.push(id);
                                } else {
                                    obj.direction.y = -obj.direction.y * 0.4;
                                }
                            }

                            if (obj.position.x < 0) {
                                obj.position.x = 0;
                                obj.direction.x = -obj.direction.x;
                            }

                            if (obj.position.x >= window.innerWidth) {
                                obj.position.x = window.innerWidth - 1;
                                obj.direction.x = -obj.direction.x;
                            }
                        }
                    })
                    .then(function() {
                        $(document).bind('keydown', 'ctrl+r', function() {
                            console.log('reset');
                            COLLAPSE.reset();
                        });
                        $(document).click(function(event) {
                            var element = event.target;
                            if (element.offsetWidth * element.offsetHeight < 300000) {
                                COLLAPSE.collapse(element)
                                    .then(function() {
                                        scene.traverse(function(node) {
                                            if (node instanceof THREE.Mesh && !meshes[node.id].started) {
                                                var obj = meshes[node.id];
                                                obj.direction.y = (Math.random() * 30) + 1;
                                                obj.direction.x = (Math.random() * 50) - 25;
                                                obj.started = true;
                                            }
                                        });
                                    });
                            }
                        })
                    });
            });
        }
    </script>
</head>

<div class="container">
    <div class="header clearfix">
        <nav>
            <ul class="nav nav-pills pull-right">
                <li role="presentation" class="active"><a href="#">Home</a></li>
                <li role="presentation"><a href="#">About</a></li>
                <li role="presentation"><a href="#">Contact</a></li>
            </ul>
        </nav>
        <h3 class="text-muted">Project name</h3>
    </div>

    <div class="jumbotron">
        <h1 class="breakable">Collapse</h1>
        <p class="lead">
            Cras justo odio, dapibus ac facilisis in, egestas eget quam. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.
        </p>
        <p><a class="btn btn-lg btn-success" href="#" role="button">Sign up today</a></p>
    </div>

    <div class="row marketing">
        <div class="col-lg-6">
            <h4>Subheading</h4>
            <p>Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum.</p>

            <h4>Subheading</h4>
            <p>Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Cras mattis consectetur purus sit amet fermentum.</p>

            <h4>Subheading</h4>
            <p>Maecenas sed diam eget risus varius blandit sit amet non magna.</p>
        </div>

        <div class="col-lg-6">
            <h4>Subheading</h4>
            <p>Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum.</p>

            <h4>Subheading</h4>
            <p>Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Cras mattis consectetur purus sit amet fermentum.</p>

            <h4>Subheading</h4>
            <p>Maecenas sed diam eget risus varius blandit sit amet non magna.</p>
        </div>
    </div>

    <footer class="footer">
        <p>&copy; 2015 Company, Inc.</p>
    </footer>

</div>
<!-- /container -->

</html>
