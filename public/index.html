<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="css/collapse.css" />

    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/dom-to-image.min.js"></script>
    <script type="text/javascript" src="js/three.min.js"></script>
    <script type="text/javascript" src="js/collapse.js"></script>
    <script type="text/javascript">
        var enable = true;

        if (enable) {
            var worker = new Worker('js/worker.js');
            worker.onmessage = function(message) {

            }

            $(window).load(function() {
                // disassemble('body')
                // .then(addPixels)
                // Array.prototype.slice.call(document.querySelectorAll(".breakable"))
                //     .forEach(element => element.style.visibility = 'hidden');
                Promise.resolve(setupScene([]))
                    .then(handleScene)
                    .then(_ => {
                      $(document).click(event => {
                          const element = event.toElement;
                          if (element.tagName.toLowerCase() != 'body') {
                              collapse(event.toElement).then(addPixels).then(images => imageToMesh(images[0])).then(_ => {
                                  scene.traverse(node => {
                                      if (node instanceof THREE.Mesh && !meshes[node.id].started) {
                                          const obj = meshes[node.id];
                                          obj.direction.y = (Math.random() * 30) + 1;
                                          obj.direction.x = (Math.random() * 50) - 25;
                                          obj.started = true;
                                      }
                                  });
                              }).then(_ => {
                                element.style.visibility = 'hidden';
                              });
                          }
                      });
                    })
            });
        }
    </script>
</head>

<div class="container">
    <div class="header clearfix">
        <nav>
            <ul class="nav nav-pills pull-right">
                <li role="presentation" class="active"><a href="#">Home</a></li>
                <li role="presentation"><a href="#">About</a></li>
                <li role="presentation"><a href="#">Contact</a></li>
            </ul>
        </nav>
        <h3 class="text-muted">Project name</h3>
    </div>

    <div class="jumbotron">
        <h1 class="breakable">Collapse</h1>
        <p class="lead">Cras justo odio, dapibus ac facilisis in, egestas eget quam. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.</p>
        <p><a class="btn btn-lg btn-success" href="#" role="button">Sign up today</a></p>
    </div>

    <div class="row marketing">
        <div class="col-lg-6">
            <h4>Subheading</h4>
            <p>Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum.</p>

            <h4>Subheading</h4>
            <p>Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Cras mattis consectetur purus sit amet fermentum.</p>

            <h4>Subheading</h4>
            <p>Maecenas sed diam eget risus varius blandit sit amet non magna.</p>
        </div>

        <div class="col-lg-6">
            <h4>Subheading</h4>
            <p>Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum.</p>

            <h4>Subheading</h4>
            <p>Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Cras mattis consectetur purus sit amet fermentum.</p>

            <h4>Subheading</h4>
            <p>Maecenas sed diam eget risus varius blandit sit amet non magna.</p>
        </div>
    </div>

    <footer class="footer">
        <p>&copy; 2015 Company, Inc.</p>
    </footer>

</div>
<!-- /container -->

</html>
